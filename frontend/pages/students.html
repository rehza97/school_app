<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ุงูุทูุงุจ - ูุธุงู ุงูุญุถูุฑ ุงููุฏุฑุณู</title>
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>๐</text></svg>"
    />
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/students.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <!-- Add SheetJS library for Excel parsing -->
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <!-- Global Database Module -->
    <script src="../js/database.js"></script>
  </head>
  <body>
    <div class="container">
      <!-- Sidebar -->
      <nav class="sidebar">
        <div class="logo">
          <h2>ุฅุฏุงุฑุฉ ุงููุฏุฑุณุฉ</h2>
          <button
            id="themeToggle"
            class="theme-toggle"
            title="ุชุจุฏูู ุงููุถุน ุงููุธูู"
          >
            <i class="fas fa-moon"></i>
          </button>
        </div>
        <ul class="nav-links">
          <li>
            <a href="../index.html"><i class="fas fa-home"></i> ููุญุฉ ุงูุชุญูู</a>
          </li>
          <li class="active">
            <a href="students.html"
              ><i class="fas fa-user-graduate"></i> ุงูุทูุงุจ</a
            >
          </li>
          <li>
            <a href="teachers.html"
              ><i class="fas fa-chalkboard-teacher"></i> ุงููุนูููู</a
            >
          </li>
          <li>
            <a href="classes.html"><i class="fas fa-school"></i> ุงููุตูู</a>
          </li>
          <li>
            <a href="attendance.html"
              ><i class="fas fa-calendar-check"></i> ุงูุญุถูุฑ</a
            >
          </li>
          <li>
            <a href="reports.html"><i class="fas fa-chart-bar"></i> ุงูุชูุงุฑูุฑ</a>
          </li>
          <li>
            <a href="settings.html"><i class="fas fa-cog"></i> ุงูุฅุนุฏุงุฏุงุช</a>
          </li>
        </ul>
      </nav>

      <!-- Main Content -->
      <main class="main-content">
        <header>
          <div class="header-content">
            <h1>ุฅุฏุงุฑุฉ ุงูุทูุงุจ</h1>
            <div class="user-info">
              <span class="user-name">ุงููุฏูุฑ</span>
              <i class="fas fa-user-circle"></i>
            </div>
          </div>
        </header>

        <div class="students-container">
          <!-- Quick Stats -->
          <div class="stats-container">
            <div class="stat-card">
              <i class="fas fa-users"></i>
              <div class="stat-info">
                <h3>ุฅุฌูุงูู ุงูุทูุงุจ</h3>
                <p id="totalStudents">0</p>
              </div>
            </div>
            <div class="stat-card">
              <i class="fas fa-user-check"></i>
              <div class="stat-info">
                <h3>ุงูุทูุงุจ ุงููุดุทูู</h3>
                <p id="activeStudents">0</p>
              </div>
            </div>
            <div class="stat-card">
              <i class="fas fa-user-times"></i>
              <div class="stat-info">
                <h3>ุงูุทูุงุจ ุบูุฑ ุงููุดุทูู</h3>
                <p id="inactiveStudents">0</p>
              </div>
            </div>
          </div>

          <!-- Data Import Section -->
          <div class="content-card import-card">
            <div class="card-header">
              <h3>ุงุณุชูุฑุงุฏ ุจูุงูุงุช ุงูุทูุงุจ</h3>
            </div>
            <div class="card-body">
              <p class="import-info">
                <i class="fas fa-info-circle"></i>
                ููููู ุงุณุชูุฑุงุฏ ุจูุงูุงุช ุงูุทูุงุจ ูู ููู Excel. ูุฌุจ ุฃู ูุญุชูู ุงูููู ุนูู
                ุงูุฃุนูุฏุฉ ุงูุชุงููุฉ: ุฑูู ุงูุชุนุฑููุ ุงูููุจุ ุงูุงุณูุ ุงูุฌูุณุ ุชุงุฑูุฎ
                ุงููููุงุฏุ ุงููุณูุ ุงูุณูุฉุ ููุงู ุงูุงุฒุฏูุงุฏุ ุฑูู ุนูุฏ ุงููููุงุฏุ ุนูุฏ
                ุงููููุงุฏุ ูุธุงู ุงูุชุฏุฑูุณุ ุงูุดุนุจุฉ.
              </p>
              <div class="drag-drop-zone" id="studentDragDropZone">
                <div class="upload-container">
                  <div class="file-input-wrapper">
                    <i class="fas fa-user-graduate"></i>
                    <p>ุงุณุญุจ ูุฃููุช ููู ุงูุทูุงุจ ููุง ุฃู</p>
                    <label for="studentExcelFile" class="file-label">
                      <span>ุงุฎุชุฑ ููู ุงูุทูุงุจ</span>
                    </label>
                    <input
                      type="file"
                      id="studentExcelFile"
                      accept=".xlsx, .xls"
                      title="ุญุฏุฏ ููู Excel ููุทูุงุจ"
                    />
                  </div>
                </div>
              </div>

              <!-- Excel Preview section -->
              <div id="excel-preview" class="excel-preview"></div>
            </div>
          </div>

          <!-- Preview Section -->
          <div
            class="content-card preview-card"
            id="previewSection"
            style="display: none"
          >
            <div class="card-header">
              <h3>ูุนุงููุฉ ุงูุจูุงูุงุช</h3>
              <div class="preview-controls">
                <span class="record-count"
                  >ุนุฏุฏ ุงูุณุฌูุงุช: <span id="recordCount">0</span></span
                >
                <div class="preview-buttons">
                  <button id="cancelBtn" class="btn-secondary">
                    <i class="fas fa-times"></i> ุฅูุบุงุก
                  </button>
                  <button id="uploadBtn" class="btn-primary">
                    <i class="fas fa-upload"></i> ุฑูุน ุงูููู
                  </button>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="preview-table-wrapper">
                <table id="previewTable" class="preview-table">
                  <!-- Table content will be dynamically added here -->
                </table>
              </div>
            </div>
          </div>

          <!-- Search and Filter Section -->
          <div class="content-card">
            <div class="card-header">
              <div class="filters-section">
                <div class="search-box">
                  <input
                    type="text"
                    id="searchInput"
                    placeholder="ุจุญุซ ุนู ุทุงูุจ..."
                  />
                  <i class="fas fa-search"></i>
                </div>
                <div class="filter-box">
                  <select
                    id="educationLevelFilter"
                    title="ุชุตููุฉ ุญุณุจ ุงููุณุชูู ุงูุชุนูููู"
                  >
                    <option value="">ุฌููุน ุงููุณุชููุงุช</option>
                    <!-- Education levels will be loaded dynamically -->
                  </select>
                  <select id="specialtyFilter" title="ุชุตููุฉ ุญุณุจ ุงูุชุฎุตุต">
                    <option value="">ุฌููุน ุงูุชุฎุตุตุงุช</option>
                    <!-- Specialties will be loaded dynamically -->
                  </select>
                  <select id="sectionFilter" title="ุชุตููุฉ ุญุณุจ ุงููุณู">
                    <option value="">ุฌููุน ุงูุฃูุณุงู</option>
                    <!-- Sections will be loaded dynamically -->
                  </select>
                  <select
                    id="educationSystemFilter"
                    title="ุชุตููุฉ ุญุณุจ ูุธุงู ุงูุชูุฏุฑุณ"
                  >
                    <option value="">ุฌููุน ุฃูุธูุฉ ุงูุชูุฏุฑุณ</option>
                    <!-- Education systems will be loaded dynamically -->
                  </select>
                  <select id="statusFilter" title="ุชุตููุฉ ุญุณุจ ุงูุญุงูุฉ">
                    <option value="">ุฌููุน ุงูุญุงูุงุช</option>
                    <option value="active">ูุดุท</option>
                    <option value="inactive">ุบูุฑ ูุดุท</option>
                  </select>
                </div>
                <button id="addStudentBtn" class="btn-primary">
                  <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุทุงูุจ
                </button>
              </div>
            </div>

            <!-- Students Table -->
            <div class="table-wrapper">
              <table class="data-table" id="studentsTable">
                <thead>
                  <tr>
                    <th class="sortable" data-field="registration_id">
                      ุฑูู ุงูุชุนุฑูู <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable" data-field="first_name">
                      ุงูุงุณู <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable" data-field="last_name">
                      ุงูููุจ <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable" data-field="gender">
                      ุงูุฌูุณ <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable" data-field="birth_date">
                      ุชุงุฑูุฎ ุงููููุงุฏ <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable" data-field="education_level_name">
                      ุงููุณุชูู ุงูุชุนูููู <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable" data-field="specialty_name">
                      ุงูุชุฎุตุต <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable" data-field="section_name">
                      ุงููุณู <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable" data-field="education_system_name">
                      ูุธุงู ุงูุชูุฏุฑุณ <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable" data-field="active">
                      ุงูุญุงูุฉ <span class="sort-indicator"></span>
                    </th>
                    <th>ุงูุฅุฌุฑุงุกุงุช</th>
                  </tr>
                </thead>
                <tbody id="studentsTableBody">
                  <!-- Table content will be dynamically added here -->
                </tbody>
              </table>
            </div>

            <!-- Pagination -->
            <div class="pagination">
              <button id="prevPage" class="btn-secondary">
                <i class="fas fa-chevron-right"></i> ุงูุณุงุจู
              </button>
              <span class="page-info">
                ุตูุญุฉ <span id="currentPage">1</span> ูู
                <span id="totalPages">1</span>
              </span>
              <button id="nextPage" class="btn-secondary">
                ุงูุชุงูู <i class="fas fa-chevron-left"></i>
              </button>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Add Student Modal -->
    <div id="studentModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">ุฅุถุงูุฉ ุทุงูุจ</h2>
          <button class="close-btn" title="ุฅุบูุงู">&times;</button>
        </div>
        <div class="modal-body">
          <form id="studentForm">
            <div class="form-grid">
              <!-- Basic Information -->
              <div class="form-section">
                <h3>ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ</h3>
                <div class="form-group">
                  <label for="studentId">ุฑูู ุงูุชุนุฑูู</label>
                  <input
                    type="text"
                    id="studentId"
                    name="registration_id"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="firstName">ุงูุงุณู</label>
                  <input
                    type="text"
                    id="firstName"
                    name="first_name"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="lastName">ุงูููุจ</label>
                  <input type="text" id="lastName" name="last_name" required />
                </div>
                <div class="form-group">
                  <label for="gender">ุงูุฌูุณ</label>
                  <select id="gender" name="gender" required>
                    <option value="">ุงุฎุชุฑ ุงูุฌูุณ</option>
                    <option value="ุฐูุฑ">ุฐูุฑ</option>
                    <option value="ุฃูุซู">ุฃูุซู</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="birthDate">ุชุงุฑูุฎ ุงูุงุฒุฏูุงุฏ</label>
                  <input
                    type="date"
                    id="birthDate"
                    name="birth_date"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="birthPlace">ููุงู ุงูุงุฒุฏูุงุฏ</label>
                  <input type="text" id="birthPlace" name="birth_place" />
                </div>
              </div>

              <!-- Birth Certificate Information -->
              <div class="form-section">
                <h3>ูุนูููุงุช ุนูุฏ ุงููููุงุฏ</h3>
                <div class="form-group">
                  <label for="birthByJudgment">ููููุฏ ุจุญูู</label>
                  <input
                    type="text"
                    id="birthByJudgment"
                    name="birth_by_judgment"
                  />
                </div>
                <div class="form-group">
                  <label for="birthCertificate">ุนูุฏ ุงููููุงุฏ</label>
                  <input
                    type="text"
                    id="birthCertificate"
                    name="birth_certificate"
                  />
                </div>
                <div class="form-group">
                  <label for="birthRecordYear"
                    >ุณูุฉ ุงูุชุณุฌูู ูู ุณุฌู ุงูููุงุฏุงุช</label
                  >
                  <input
                    type="text"
                    id="birthRecordYear"
                    name="birth_record_year"
                  />
                </div>
                <div class="form-group">
                  <label for="birthCertificateNumber">ุฑูู ุนูุฏ ุงููููุงุฏ</label>
                  <input
                    type="text"
                    id="birthCertificateNumber"
                    name="birth_certificate_number"
                  />
                </div>
              </div>

              <!-- Registration Information -->
              <div class="form-section">
                <h3>ูุนูููุงุช ุงูุชุณุฌูู</h3>
                <div class="form-group">
                  <label for="registrationNumber">ุฑูู ุงูููุฏ</label>
                  <input
                    type="text"
                    id="registrationNumber"
                    name="registration_number"
                  />
                </div>
                <div class="form-group">
                  <label for="registrationDate">ุชุงุฑูุฎ ุงูุชุณุฌูู ุจุงููุฏุฑุณุฉ</label>
                  <input
                    type="date"
                    id="registrationDate"
                    name="registration_date"
                  />
                </div>
                <div class="form-group">
                  <label for="educationLevel">ุงูุณูุฉ (ุงููุณุชูู ุงูุชุนูููู)</label>
                  <select id="educationLevel" name="education_level_id">
                    <option value="">ุงุฎุชุฑ ุงููุณุชูู ุงูุชุนูููู</option>
                    <!-- Education levels will be loaded dynamically -->
                  </select>
                </div>
                <div class="form-group">
                  <label for="specialty">ุงูุดุนุจุฉ (ุงูุชุฎุตุต)</label>
                  <select id="specialty" name="specialty_id">
                    <option value="">ุงุฎุชุฑ ุงูุชุฎุตุต</option>
                    <!-- Specialties will be loaded dynamically -->
                  </select>
                </div>
                <div class="form-group">
                  <label for="section">ุงููุณู</label>
                  <select id="section" name="section_id">
                    <option value="">ุงุฎุชุฑ ุงููุณู</option>
                    <!-- Sections will be loaded dynamically -->
                  </select>
                </div>
                <div class="form-group">
                  <label for="educationSystem">ูุธุงู ุงูุชูุฏุฑุณ</label>
                  <select id="educationSystem" name="education_system_id">
                    <option value="">ุงุฎุชุฑ ูุธุงู ุงูุชูุฏุฑุณ</option>
                    <!-- Education systems will be loaded dynamically -->
                  </select>
                </div>
              </div>
            </div>
            <div class="form-actions">
              <button type="button" class="btn-secondary" id="cancelModalBtn">
                ุฅูุบุงุก
              </button>
              <button type="submit" class="btn-primary">ุญูุธ</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Export Button -->
    <button
      id="exportExcelBtn"
      class="btn-primary export-btn"
      title="ุชุตุฏูุฑ ุงูุจูุงูุงุช"
    >
      <i class="fas fa-file-export"></i>
    </button>

    <!-- Custom Scripts -->
    <script src="../js/students.js"></script>
  </body>
</html>
